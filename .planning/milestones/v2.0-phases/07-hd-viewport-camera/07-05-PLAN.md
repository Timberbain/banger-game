---
phase: 07-hd-viewport-camera
plan: 05
type: execute
wave: 3
depends_on: ["07-02", "07-03"]
files_modified:
  - client/src/scenes/HUDScene.ts
  - client/src/scenes/LobbyScene.ts
  - client/src/scenes/VictoryScene.ts
  - client/src/scenes/HelpScene.ts
autonomous: true

must_haves:
  truths:
    - "HUDScene uses viewport-relative positioning (percentages of screen) for all elements"
    - "HUDScene camera stays at zoom=1 and scroll (0,0) -- NOT affected by GameScene camera zoom"
    - "HUD renders at full 1280x720 with pixelated text matching game aesthetic"
    - "Kill feed stays in top-right, ping in current position, timer in top-center"
    - "Health bars at bottom-center, cooldown below/above health area"
    - "LobbyScene background and all elements render correctly at 1280x720"
    - "VictoryScene overlay renders correctly at 1280x720"
    - "HelpScene panel renders correctly at 1280x720"
    - "Spectating banner displayed at top-center when spectating a player"
    - "No hardcoded 800, 600, 400, or 300 pixel values remain in any UI scene"
  artifacts:
    - path: "client/src/scenes/HUDScene.ts"
      provides: "Viewport-relative HUD overlay for 1280x720"
      contains: "this.cameras.main.width"
    - path: "client/src/scenes/LobbyScene.ts"
      provides: "Lobby screen rendering at 1280x720"
      contains: "1280"
    - path: "client/src/scenes/VictoryScene.ts"
      provides: "Victory overlay rendering at 1280x720"
      contains: "1280"
    - path: "client/src/scenes/HelpScene.ts"
      provides: "Help panel rendering at 1280x720"
      contains: "1280"
  key_links:
    - from: "client/src/scenes/HUDScene.ts"
      to: "client/src/ui/designTokens.ts"
      via: "Layout constants for HUD positioning"
      pattern: "Layout\\.hud"
---

<objective>
Update all UI scenes (HUD, Lobby, Victory, Help) to render correctly at 1280x720. Convert HUDScene to viewport-relative positioning. Update all background fills, element positions, and text layouts that use hardcoded 800x600 coordinates.

Purpose: Every scene the player sees must look correct at 1280x720. The HUD overlay must use viewport-relative positioning so it adapts to the resolution and stays independent of the GameScene camera zoom. Menu scenes must fill the screen with correctly centered content.
Output: All UI scenes rendering correctly at 1280x720 with no mispositioned or cut-off elements.
</objective>

<execution_context>
@/Users/jonasbrandvik/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jonasbrandvik/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@client/src/scenes/HUDScene.ts
@client/src/scenes/LobbyScene.ts
@client/src/scenes/VictoryScene.ts
@client/src/scenes/HelpScene.ts
@client/src/ui/designTokens.ts
@.planning/phases/07-hd-viewport-camera/07-RESEARCH.md
@.planning/phases/07-hd-viewport-camera/07-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert HUDScene to viewport-relative positioning at 1280x720</name>
  <files>client/src/scenes/HUDScene.ts</files>
  <action>
The HUDScene is an overlay on GameScene. Its camera must stay at zoom=1, scroll (0,0) so it renders at full 1280x720 independent of the GameScene camera.

**Approach:** Use `const W = this.cameras.main.width` and `const H = this.cameras.main.height` as the base for all positioning. Store these as member variables set in create().

**Audit and replace ALL hardcoded positions.** The current HUDScene has many pixel values based on the old 800x600 canvas. Each must be converted to viewport-relative:

| Element | Old Position | New Position (viewport-relative) |
|---------|-------------|----------------------------------|
| Role reminder | x=10, y=10 | x = W * 0.01, y = H * 0.02 |
| Timer | x=400, y=20 | x = W * 0.5, y = H * 0.03 |
| Ping | x=780, y=20 | x = W * 0.97, y = H * 0.03 |
| Kill feed | x=790, y=60 | x = W * 0.98, y = H * 0.08 |
| Kill feed spacing | 20px apart | H * 0.03 apart |
| Cooldown bar | x=400, y=538 | x = W * 0.5, y = H * 0.92 |
| Health bars | y=575 | y = H * 0.95 |
| Spectator text | x=400, y=50-75 | x = W * 0.5, y = H * 0.07-0.10 |
| Role banner | x=400, y=200 | x = W * 0.5, y = H * 0.28 |
| "FIGHT!" text | x=400, y=300 | x = W * 0.5, y = H * 0.42 |
| screenWidth = 800 | hardcoded | W (dynamic) |

**Key rules:**
1. Camera stays at zoom=1 (confirm `this.cameras.main.setScroll(0, 0)` is present in create, do NOT set zoom)
2. Use `this.cameras.main.width` / `this.cameras.main.height` for all calculations
3. HUD text should use the same monospace pixel font as before -- pixelated text matching game aesthetic
4. All elements must be fixed screen overlay (not scrolling with world camera) -- already the case with scroll(0,0)
5. Health bar widths and heights can stay as absolute pixel values (they represent a fixed UI widget size)
6. Kill feed entry text can stay as absolute font sizes

Also look for any remaining `800` or `600` or `400` or `300` literal values in HUDScene and convert them.

**Spectator banner:** Ensure the "Spectating: [Player Name]" text is positioned at top-center (W * 0.5, H * 0.07) with semi-transparent dark background rectangle behind it, and role-colored text.
  </action>
  <verify>
1. `grep -n "this.cameras.main.width" client/src/scenes/HUDScene.ts` shows viewport-relative usage
2. `grep -cE "\\b800\\b|\\b600\\b" client/src/scenes/HUDScene.ts` returns 0 (no old values)
3. `grep -n "setScroll(0, 0)" client/src/scenes/HUDScene.ts` confirms fixed overlay
4. `grep -n "Spectating" client/src/scenes/HUDScene.ts` shows spectator banner
  </verify>
  <done>HUDScene uses viewport-relative positioning throughout, renders at 1280x720 with zoom=1, all elements correctly placed with no hardcoded 800x600 values, spectator banner at top-center.</done>
</task>

<task type="auto">
  <name>Task 2: Update LobbyScene, VictoryScene, and HelpScene for 1280x720</name>
  <files>client/src/scenes/LobbyScene.ts, client/src/scenes/VictoryScene.ts, client/src/scenes/HelpScene.ts</files>
  <action>
These scenes render full-screen menus. Each needs all hardcoded 800x600 references updated to 1280x720.

**LobbyScene (~1130 lines -- many positions to update):**
- Background: `setDisplaySize(1280, 720)` (was 800, 600)
- Overlay rectangle: `rectangle(640, 360, 1280, 720, ...)` (was 400, 300, 800, 600)
- All text centering: use `this.cameras.main.centerX` (640) and `this.cameras.main.centerY` (360) or explicit 640/360
- Character selection panels: space them evenly across 1280 width (e.g., at x=320, 640, 960 for 3 panels)
- Buttons: center at x=640
- Room code display: adjust position
- HTML input elements: if positioned via CSS, update pixel coordinates
- Status text, player list, decorative elements: all centered/positioned for 1280x720
- Any vine/sparkle decorations: scale to fill 1280x720

Audit for ALL occurrences of `800`, `600`, `400`, `300` and replace:
- `800` -> `1280` (full width)
- `600` -> `720` (full height)
- `400` -> `640` (center X)
- `300` -> `360` (center Y)

Some values may not be simple replacements (e.g., `300` as a Y offset that isn't center). Use judgment: if a value is clearly derived from half-canvas-width, replace with 640. If it's a spacing value, scale proportionally.

**VictoryScene (~196 lines):**
- Background overlay: `setDisplaySize(1280, 720)` or `rectangle(640, 360, 1280, 720, ...)`
- Stats table: center at 640, adjust Y positions proportionally
- Button positions: center at 640
- Victory/defeat text: center at 640
- Victory burst particle position: center of screen = 640, 360 (was 400, 300)
- Any `800`/`600`/`400`/`300` → `1280`/`720`/`640`/`360`

**HelpScene (~217 lines):**
- Background overlay: `rectangle(640, 360, 1280, 720, ...)`
- Panel dimensions: scale proportionally (wider panel for 1280)
- Text content positions: center and space for 1280x720
- Close button: position at top-right of panel
- Any `800`/`600`/`400`/`300` → `1280`/`720`/`640`/`360`

**Common pattern for all 3 scenes:**
Where possible, use `this.cameras.main.centerX` and `this.cameras.main.centerY` instead of hardcoded values. This makes future resolution changes easier.
  </action>
  <verify>
1. `grep -cE "\\b800\\b" client/src/scenes/LobbyScene.ts` returns 0 (or minimal non-coordinate uses)
2. `grep -cE "\\b800\\b" client/src/scenes/VictoryScene.ts` returns 0
3. `grep -cE "\\b800\\b" client/src/scenes/HelpScene.ts` returns 0
4. `grep -n "1280" client/src/scenes/LobbyScene.ts` shows updated width references
5. `grep -n "1280" client/src/scenes/VictoryScene.ts` shows updated references
6. `grep -n "640, 360" client/src/scenes/LobbyScene.ts` shows centered elements
  </verify>
  <done>LobbyScene, VictoryScene, and HelpScene all render correctly at 1280x720 with centered content, properly scaled backgrounds, and no hardcoded 800x600 coordinate remnants.</done>
</task>

</tasks>

<verification>
- HUDScene: all positions viewport-relative, no 800/600 values, zoom=1 overlay
- LobbyScene: fills 1280x720, centered elements, character panels spaced correctly
- VictoryScene: fills 1280x720, stats centered, victory burst at screen center
- HelpScene: fills 1280x720, panel centered and scaled
- No scene has hardcoded 800, 600, 400, or 300 pixel values for positioning
</verification>

<success_criteria>
All UI scenes display correctly at 1280x720 with no elements cut off, mispositioned, or overlapping. HUD uses viewport-relative positioning for future resolution flexibility. The game experience from boot to lobby to match to victory looks correct at the new resolution.
</success_criteria>

<output>
After completion, create `.planning/phases/07-hd-viewport-camera/07-05-SUMMARY.md`
</output>
